{
  "input": {
    "message": "{\"Version\":1,\"Type\":20107,\"TypeComputedMap\":\"AgentOperationIocAnalysisTextualSearchProcessMatch\",\"Severity\":4,\"ServerReserved\":0,\"Attributes\":2,\"AttributesComputedBitMap\":[\"Protection\"],\"EventGuid\":\"{AD01D628-71C0-4432-A358-142306F65E42}\",\"GenerateIncident\":false,\"Timestamp\":\"2023-06-15T04:49:04.5989765+02:00\",\"TimestampRaw\":133311341445989765,\"SpecificData\":{\"Action\":{\"PolicyGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"PolicyVersion\":0,\"RuleGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"BaseRuleGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"IdentifierGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"Blocked\":false,\"RequestMoveToQuarantine\":false,\"UserDecision\":false,\"SourceProcessKilled\":false},\"AnalysisProperties\":{\"AnalysisUnitGuid\":\"{C6F96B4B-22E1-4F77-B74B-BBB94E7DCEC5}\",\"Triggers\":128,\"TriggersComputedBitMap\":[\"TRIGGER_SECOPS\"],\"AssociatedEventGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"AssociatedScheduledTaskGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"AssociatedSecOpsGuid\":\"{D4782D23-E46A-462E-8934-BFDC32920706}\",\"AssociatedSecOpsRequestGuid\":\"{F5B8FBB4-9B35-45E7-80B6-2D6B81BDB126}\",\"AssociatedBaseRuleGuid\":\"{BB1C16CA-8916-4891-9A65-078284B20EA1}\",\"AssociatedRuleGuid\":\"{8CFC6AE9-E111-403E-90AF-1912774CBEC4}\"},\"SourceProcess\":{\"PID\":4032,\"ProcessGuid\":\"{358F6CB9-1326-469E-807D-9742D7799F1F}\",\"ProcessImageName\":\"C:\\\\Windows\\\\explorer.exe\",\"VolumeZone\":1,\"VolumeZoneComputedBitMap\":[\"Operating system\"],\"ProcessCommandLine\":\"C:\\\\Windows\\\\Explorer.EXE\",\"User\":\"S-1-5-21-2222222-33333333-44444444-555\",\"UserNameLookup\":\"JOHNDOE\",\"UserDomainLookup\":\"TEST\",\"IntegrityLevel\":\"S-1-16-8192\",\"IntegrityLevelNameLookup\":\"Niveauobligatoiremoyen\",\"IntegrityLevelDomainLookup\":\"\u00c9tiquetteobligatoire\",\"SessionID\":2,\"HashMd5\":\"AC4C51EB24AA95B77F705AB159189E24\",\"HashSha1\":\"4583DAF9442880204730FB2C8A060430640494B1\",\"HashSha256\":\"6A671B92A69755DE6FD063FCBE4BA926D83B49F78C42DBAEED8CDB6BBC57576A\",\"IsProtectedOrCritical\":false,\"CertificateSignatureState\":1,\"CertificateSignatureStateComputedMap\":\"SignatureStateTrusted\",\"Certificates\":[{\"Algorithm\":\"SHA1\",\"IssuerCN\":\"MicrosoftWindowsVerificationPCA\",\"SubjectCN\":\"MicrosoftWindows\",\"SigningTime\":\"2010-11-20T21:37:13.0000000+02:00\",\"ValidityStart\":\"2009-12-07T23:57:40.0000000+02:00\",\"ValidityEnd\":\"2011-03-07T23:57:40.0000000+02:00\"}],\"ProcessStartTime\":\"2023-06-13T14:21:19.3323750+02:00\",\"ProcessStartTimeRaw\":133311324793323750},\"SourceProcessImageFileDetails\":{\"FileFullPath\":\"C:\\\\Windows\\\\explorer.exe\",\"FileCreateTime\":\"2010-11-21T05:24:35.3136502+02:00\",\"LastModified\":\"2010-11-21T05:24:35.3448503+02:00\",\"Owner\":\"S-1-5-21-2222222-33333333-44444444-555-2271478464\",\"OwnerNameLookup\":\"TrustedInstaller\",\"OwnerDomainLookup\":\"NTSERVICE\",\"HashMd5\":\"AC4C51EB24AA95B77F705AB159189E24\",\"HashSha1\":\"4583DAF9442880204730FB2C8A060430640494B1\",\"HashSha256\":\"6A671B92A69755DE6FD063FCBE4BA926D83B49F78C42DBAEED8CDB6BBC57576A\",\"HashSSDeep\":\"49152:jxrceI/lIRYraisQhFCUCAvYYYYYYYYYYYRYYYYYYYYYYE3iA7/eFUJN9ojoso2W:FrcPlIWFvYYYYYYYYYYYRYYYYYYYYYY4\"},\"MatchedStrings\":[\"fichiertexte.txt\",\"hello\",\"qa_custom_dll_caller.exe\",\"toto\"]}}"
  },
  "expected": {
    "message": "{\"Version\":1,\"Type\":20107,\"TypeComputedMap\":\"AgentOperationIocAnalysisTextualSearchProcessMatch\",\"Severity\":4,\"ServerReserved\":0,\"Attributes\":2,\"AttributesComputedBitMap\":[\"Protection\"],\"EventGuid\":\"{AD01D628-71C0-4432-A358-142306F65E42}\",\"GenerateIncident\":false,\"Timestamp\":\"2023-06-15T04:49:04.5989765+02:00\",\"TimestampRaw\":133311341445989765,\"SpecificData\":{\"Action\":{\"PolicyGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"PolicyVersion\":0,\"RuleGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"BaseRuleGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"IdentifierGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"Blocked\":false,\"RequestMoveToQuarantine\":false,\"UserDecision\":false,\"SourceProcessKilled\":false},\"AnalysisProperties\":{\"AnalysisUnitGuid\":\"{C6F96B4B-22E1-4F77-B74B-BBB94E7DCEC5}\",\"Triggers\":128,\"TriggersComputedBitMap\":[\"TRIGGER_SECOPS\"],\"AssociatedEventGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"AssociatedScheduledTaskGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"AssociatedSecOpsGuid\":\"{D4782D23-E46A-462E-8934-BFDC32920706}\",\"AssociatedSecOpsRequestGuid\":\"{F5B8FBB4-9B35-45E7-80B6-2D6B81BDB126}\",\"AssociatedBaseRuleGuid\":\"{BB1C16CA-8916-4891-9A65-078284B20EA1}\",\"AssociatedRuleGuid\":\"{8CFC6AE9-E111-403E-90AF-1912774CBEC4}\"},\"SourceProcess\":{\"PID\":4032,\"ProcessGuid\":\"{358F6CB9-1326-469E-807D-9742D7799F1F}\",\"ProcessImageName\":\"C:\\\\Windows\\\\explorer.exe\",\"VolumeZone\":1,\"VolumeZoneComputedBitMap\":[\"Operating system\"],\"ProcessCommandLine\":\"C:\\\\Windows\\\\Explorer.EXE\",\"User\":\"S-1-5-21-2222222-33333333-44444444-555\",\"UserNameLookup\":\"JOHNDOE\",\"UserDomainLookup\":\"TEST\",\"IntegrityLevel\":\"S-1-16-8192\",\"IntegrityLevelNameLookup\":\"Niveauobligatoiremoyen\",\"IntegrityLevelDomainLookup\":\"\u00c9tiquetteobligatoire\",\"SessionID\":2,\"HashMd5\":\"AC4C51EB24AA95B77F705AB159189E24\",\"HashSha1\":\"4583DAF9442880204730FB2C8A060430640494B1\",\"HashSha256\":\"6A671B92A69755DE6FD063FCBE4BA926D83B49F78C42DBAEED8CDB6BBC57576A\",\"IsProtectedOrCritical\":false,\"CertificateSignatureState\":1,\"CertificateSignatureStateComputedMap\":\"SignatureStateTrusted\",\"Certificates\":[{\"Algorithm\":\"SHA1\",\"IssuerCN\":\"MicrosoftWindowsVerificationPCA\",\"SubjectCN\":\"MicrosoftWindows\",\"SigningTime\":\"2010-11-20T21:37:13.0000000+02:00\",\"ValidityStart\":\"2009-12-07T23:57:40.0000000+02:00\",\"ValidityEnd\":\"2011-03-07T23:57:40.0000000+02:00\"}],\"ProcessStartTime\":\"2023-06-13T14:21:19.3323750+02:00\",\"ProcessStartTimeRaw\":133311324793323750},\"SourceProcessImageFileDetails\":{\"FileFullPath\":\"C:\\\\Windows\\\\explorer.exe\",\"FileCreateTime\":\"2010-11-21T05:24:35.3136502+02:00\",\"LastModified\":\"2010-11-21T05:24:35.3448503+02:00\",\"Owner\":\"S-1-5-21-2222222-33333333-44444444-555-2271478464\",\"OwnerNameLookup\":\"TrustedInstaller\",\"OwnerDomainLookup\":\"NTSERVICE\",\"HashMd5\":\"AC4C51EB24AA95B77F705AB159189E24\",\"HashSha1\":\"4583DAF9442880204730FB2C8A060430640494B1\",\"HashSha256\":\"6A671B92A69755DE6FD063FCBE4BA926D83B49F78C42DBAEED8CDB6BBC57576A\",\"HashSSDeep\":\"49152:jxrceI/lIRYraisQhFCUCAvYYYYYYYYYYYRYYYYYYYYYYE3iA7/eFUJN9ojoso2W:FrcPlIWFvYYYYYYYYYYYRYYYYYYYYYY4\"},\"MatchedStrings\":[\"fichiertexte.txt\",\"hello\",\"qa_custom_dll_caller.exe\",\"toto\"]}}",
    "event": {
      "code": "AgentOperationIocAnalysisTextualSearchProcessMatch",
      "severity": 4
    },
    "@timestamp": "2023-06-15T02:49:04.598976Z",
    "process": {
      "command_line": "C:\\Windows\\Explorer.EXE",
      "executable": "C:\\Windows\\explorer.exe",
      "hash": {
        "md5": "AC4C51EB24AA95B77F705AB159189E24",
        "sha1": "4583DAF9442880204730FB2C8A060430640494B1",
        "sha256": "6A671B92A69755DE6FD063FCBE4BA926D83B49F78C42DBAEED8CDB6BBC57576A"
      },
      "name": "explorer.exe",
      "pid": 4032,
      "start": "2023-06-13T12:21:19.332375Z",
      "user": {
        "id": "S-1-5-21-2222222-33333333-44444444-555",
        "name": "JOHNDOE"
      }
    },
    "related": {
      "hash": [
        "4583DAF9442880204730FB2C8A060430640494B1",
        "6A671B92A69755DE6FD063FCBE4BA926D83B49F78C42DBAEED8CDB6BBC57576A",
        "AC4C51EB24AA95B77F705AB159189E24"
      ]
    },
    "rule": {
      "uuid": "00000000-0000-0000-0000-000000000000"
    },
    "stormshield": {
      "ses": {
        "action": {
          "blocked": false,
          "user_decision": false
        },
        "process": {
          "user": {
            "domain": "TEST"
          }
        },
        "source_process": {
          "killed": false
        },
        "type": "20107"
      }
    }
  }
}