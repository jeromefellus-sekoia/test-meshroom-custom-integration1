[
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "flows"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "flows"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "firewall"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "firewall"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "vpn_firewall"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "vpn_firewall"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "cellular_firewall"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "cellular_firewall"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "bridge_anyconnect_client_vpn_firewall"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} was {action.outcome}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "action.outcome"
      },
      {
        "field": "event.dataset",
        "value": "bridge_anyconnect_client_vpn_firewall"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} started",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "event.dataset",
        "value": "ip_flow_start"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} ended",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "event.dataset",
        "value": "ip_flow_end"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} started",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "event.dataset",
        "value": "ip_flow_start"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "ICMP connection from {source.ip} to {destination.ip} ended",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "event.dataset",
        "value": "ip_flow_end"
      },
      {
        "field": "network.protocol",
        "value": "icmp"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "requested"
      }
    ]
  },
  {
    "value": "Source {source.ip} made {http.request.method} request to {url.original}",
    "conditions": [
      {
        "field": "url.original"
      },
      {
        "field": "event.dataset",
        "value": "urls"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "url.original",
        "type": "HTTP {http.request.method} request"
      },
      {
        "source": "url.original",
        "target": "url.domain",
        "type": "hosted on"
      },
      {
        "source": "url.domain",
        "target": "destination.ip",
        "type": "resolved to"
      },
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "connected on"
      }
    ]
  },
  {
    "value": "DHCP offer for {source.ip} to {source.mac}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "events"
      },
      {
        "field": "cisco_meraki.event_subtype",
        "value": "dhcp_offer"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "source.mac"
      }
    ],
    "relationships": [
      {
        "source": "source.mac",
        "target": "source.ip",
        "type": "requested ip"
      }
    ]
  },
  {
    "value": "DHCP request not statisfied for {source.mac}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "events"
      },
      {
        "field": "cisco_meraki.event_subtype",
        "value": "dhcp_no_offer"
      },
      {
        "field": "source.mac"
      }
    ]
  },
  {
    "value": "VPN connection success for user {user.name} from {source.ip}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "events"
      },
      {
        "field": "cisco_meraki.event_subtype",
        "value": "anyconnect_vpn_auth_success"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "connected from"
      }
    ]
  },
  {
    "value": "VPN connection success for user {user.name} from {source.ip}. Acquired ip {source.nat.ip}",
    "conditions": [
      {
        "field": "cisco_meraki.event_subtype",
        "value": "anyconnect_vpn_connect"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "source.nat.ip"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "connected from"
      },
      {
        "source": "user.name",
        "target": "source.nat.ip",
        "type": "local ip"
      }
    ]
  },
  {
    "value": "VPN connection success for user {user.name} from {source.ip}",
    "conditions": [
      {
        "field": "cisco_meraki.event_subtype",
        "value": "anyconnect_vpn_connection_success"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "connected from"
      }
    ]
  },
  {
    "value": "VPN connection failed from {source.ip}",
    "conditions": [
      {
        "field": "cisco_meraki.event_subtype",
        "value": "anyconnect_vpn_auth_failure"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{user.name} ({source.ip}): {cisco_meraki.event_subtype}",
    "conditions": [
      {
        "field": "cisco_meraki.event_subtype"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{source.ip}: {cisco_meraki.event_subtype}",
    "conditions": [
      {
        "field": "cisco_meraki.event_subtype"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{source.mac}: {cisco_meraki.event_subtype}",
    "conditions": [
      {
        "field": "cisco_meraki.event_subtype"
      },
      {
        "field": "source.mac"
      }
    ]
  }
]
