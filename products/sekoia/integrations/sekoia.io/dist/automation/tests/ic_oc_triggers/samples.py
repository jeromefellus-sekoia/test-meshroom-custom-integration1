# flake8: noqa

import pytest


@pytest.fixture
def samplenotif_alert_created():
    yield {
        "metadata": {
            "version": 2,
            "uuid": "a8fb31cb-7310-4f59-afc2-d52033b5cf78",
            "created_at": "2019-09-06T07:32:03.256679+00:00",
            "community_uuid": "cc93fe3f-c26b-4eb1-82f7-082209cf1892",
        },
        "type": "alert",
        "action": "created",
        "attributes": {
            "uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
            "short_id": "ALakbd8NXp9W",
        },
    }


@pytest.fixture
def samplenotif_alert_status_changed():
    yield {
        "metadata": {
            "version": 2,
            "community_uuid": "6ffbe55b-d30a-4dc4-bc52-a213dce0af29",
            "created_at": "2019-09-06T07:07:54.830677+00:00",
            "uuid": "02e10dca-e86e-462e-85cf-cd4c56b7d7e8",
        },
        "type": "alert",
        "action": "updated",
        "attributes": {
            "updated": {"status": "8f206505-af6d-433e-93f4-775d46dc7d0f", "status_name": "Acknowledged"},
            "uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
            "short_id": "ALakbd8NXp9W",
        },
    }


@pytest.fixture
def samplenotif_alert_updated():
    yield {
        "metadata": {
            "version": 2,
            "community_uuid": "6ffbe55b-d30a-4dc4-bc52-a213dce0af29",
            "created_at": "2019-09-06T07:07:54.830677+00:00",
            "uuid": "b47e4dad-e1de-4f9d-b77c-1c0bb61b20fe",
        },
        "type": "alert",
        "action": "updated",
        "attributes": {
            "updated": {"dynamic_urgency_value": 20},
            "uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
            "short_id": "ALakbd8NXp9W",
        },
    }


@pytest.fixture
def samplenotif_alert_comment_created():
    yield {
        "metadata": {
            "version": 2,
            "community_uuid": "6ffbe55b-d30a-4dc4-bc52-a213dce0af29",
            "uuid": "94ef1f9d-ebad-42ba-98d7-2be3447c6bd0",
            "created_at": "2019-09-06T07:07:54.830677+00:00",
        },
        "type": "alert-comment",
        "action": "created",
        "attributes": {
            "content": "comment",
            "created_by": "c110d686-0b45-4ae7-b917-f15486d0f8c7",
            "created_by_type": "user",
            "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
            "alert_short_id": "ALakbd8NXp9W",
            "uuid": "5869b4d8-e3bb-4465-baad-95daf28267c7",
        },
    }


@pytest.fixture
def sample_notifications(
    samplenotif_alert_created,
    samplenotif_alert_updated,
    samplenotif_alert_status_changed,
    samplenotif_alert_comment_created,
):
    yield [
        samplenotif_alert_created,
        samplenotif_alert_updated,
        samplenotif_alert_status_changed,
        samplenotif_alert_comment_created,
    ]


@pytest.fixture
def sample_sicalertapi():
    """Sample SICAlertAPI response for an alert with
    UUID af0a370f-2e44-433c-99b2-2d0e4b348d0c

    """

    yield {
        "source": "10.227.10.91",
        "alert_type": {"category": "malicious-traffic", "value": "rat-traffic"},
        "is_incident": False,
        "comments": [],
        "countermeasures": [
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "de66615c-4e28-4da4-bfa4-7b5caf5ee19e",
                "model_uuid": "7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure 7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Launch a forensics tool to collect information on suspicious system",
                        "name": "1",
                        "activated_at": None,
                        "object": {
                            "action": "start",
                            "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                            "args": {"where": "$DROP_ZONE"},
                            "target": {"process": {}},
                        },
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 80,
                "denied_by_type": None,
                "description": "Launch a forensics tool to collect information on suspicious system",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                    "name": "Countermeasure 7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                    "description": "Launch a forensics tool to collect information on suspicious system",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Launch a forensics tool to collect information on suspicious system",
                            "object": {
                                "action": "start",
                                "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"process": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 80.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "51d50a83-31da-46b0-aa22-5adcd37aedb2",
                "model_uuid": "4ba7d84d-0291-498e-b661-3cec45943ac7",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure 4ba7d84d-0291-498e-b661-3cec45943ac7",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic source",
                        "name": "1",
                        "activated_at": None,
                        "object": {
                            "action": "copy",
                            "actuator": {"network-fpc": {}},
                            "args": {"where": "$DROP_ZONE"},
                            "target": {"ip_connection": {"src-addr": "192.0.0.241"}},
                        },
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 70,
                "denied_by_type": None,
                "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic source",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--4ba7d84d-0291-498e-b661-3cec45943ac7",
                    "name": "Countermeasure 4ba7d84d-0291-498e-b661-3cec45943ac7",
                    "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic source",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic source",
                            "object": {
                                "action": "copy",
                                "actuator": {"network-fpc": {}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"ip_connection": {"src-addr": "192.0.0.241"}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 70.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "909fda4e-6823-41bb-8998-afd75424a6b3",
                "model_uuid": "9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure 9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic destination",
                        "name": "1",
                        "activated_at": None,
                        "object": {
                            "action": "copy",
                            "actuator": {"network-fpc": {}},
                            "args": {"where": "$DROP_ZONE"},
                            "target": {"ip_connection": {"dst-addr": "192.0.0.241"}},
                        },
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 70,
                "denied_by_type": None,
                "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic destination",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                    "name": "Countermeasure 9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                    "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic destination",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic destination",
                            "object": {
                                "action": "copy",
                                "actuator": {"network-fpc": {}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"ip_connection": {"dst-addr": "192.0.0.241"}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 70.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "ce4abd6b-1553-413e-b549-9392de801c52",
                "model_uuid": "2c5f2708-be09-4703-8790-38f600e05328",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure 2c5f2708-be09-4703-8790-38f600e05328",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Collect memory to analyze malware later",
                        "name": "1",
                        "activated_at": None,
                        "object": {
                            "action": "snapshot",
                            "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                            "args": {"where": "$DROP_ZONE"},
                            "target": {"memory": {}},
                        },
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 50,
                "denied_by_type": None,
                "description": "Collect memory to analyze malware later",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--2c5f2708-be09-4703-8790-38f600e05328",
                    "name": "Countermeasure 2c5f2708-be09-4703-8790-38f600e05328",
                    "description": "Collect memory to analyze malware later",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Collect memory to analyze malware later",
                            "object": {
                                "action": "snapshot",
                                "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"memory": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 50.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "d6ce6868-207c-4a59-9775-55fdd1c2318c",
                "model_uuid": "ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Search for additional information on the case",
                        "name": "1",
                        "activated_at": None,
                        "object": {"action": "investigate", "target": {"artifact": {}}},
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 73,
                "denied_by_type": None,
                "description": "Search for additional information on the case",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                    "name": "Countermeasure ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                    "description": "Search for additional information on the case",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Search for additional information on the case",
                            "object": {
                                "action": "investigate",
                                "target": {"artifact": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 72.5, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "ced96fc1-d6f1-4935-9978-3f367552234c",
                "model_uuid": "6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure 6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Retrieve the list of running processes",
                        "name": "1",
                        "activated_at": None,
                        "object": {
                            "action": "query",
                            "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                            "args": {"where": "$DROP_ZONE"},
                            "target": {"process": {}},
                        },
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 58,
                "denied_by_type": None,
                "description": "Retrieve the list of running processes",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                    "name": "Countermeasure 6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                    "description": "Retrieve the list of running processes",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Retrieve the list of running processes",
                            "object": {
                                "action": "query",
                                "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"process": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 57.5, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
            {
                "activated_by_type": None,
                "duration": None,
                "activated_by": None,
                "comments": [],
                "activated_at": None,
                "uuid": "cb83cf8b-c31a-4df7-b05b-c78ef3446fc2",
                "model_uuid": "88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                "created_by_type": "application",
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "name": "Countermeasure 88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                "action_steps": [
                    {
                        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                        "description": "Block the IP address of the destination system",
                        "name": "1",
                        "activated_at": None,
                        "object": {
                            "action": "deny",
                            "actuator": {"network-firewall": {"location": "$GLOBAL"}},
                            "target": {"ip_addr": "192.0.0.241"},
                        },
                        "action_order": "0",
                        "denied_by": None,
                        "created_at": "2019-09-06T07:32:00.758000+00:00",
                        "activated_by_type": None,
                        "denied_at": None,
                        "denied_by_type": None,
                        "status": "created",
                        "created_by_type": "application",
                        "activated_by": None,
                        "comments": [],
                    }
                ],
                "relevance": 80,
                "denied_by_type": None,
                "description": "Block the IP address of the destination system",
                "alert_uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
                "denied_by": None,
                "dynamic_relevance": 0,
                "created_at": "2019-09-06T07:32:00.758000+00:00",
                "denied_at": None,
                "course_of_action": {
                    "id": "course-of-action--88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                    "name": "Countermeasure 88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                    "description": "Block the IP address of the destination system",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Block the IP address of the destination system",
                            "object": {
                                "action": "deny",
                                "actuator": {"network-firewall": {"location": "$GLOBAL"}},
                                "target": {"ip_addr": "192.0.0.241"},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 80.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                "status": "created",
            },
        ],
        "kill_chain_short_id": None,
        "uuid": "af0a370f-2e44-433c-99b2-2d0e4b348d0c",
        "entity": {
            "uuid": "20b0b40f-ee42-405e-802b-c576ff3f722d",
            "name": "Vessel 1235",
        },
        "updated_at": 1567755122,
        "updated_by_type": "application",
        "short_id": "ALTqhwoRAyqk",
        "created_by_type": "application",
        "details": "Traffic associated to a Remote Administration Tool",
        "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
        "stix": {
            "type": "bundle",
            "id": "bundle--0661dffc-6deb-45c0-8a41-36187d932543",
            "spec_version": "2.0",
            "objects": [
                {
                    "id": "sighting--a313284d-2e0b-4169-9236-bd8b166d8afa",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.758Z",
                    "modified": "2019-09-06T07:32:00.758Z",
                    "first_seen": "2019-09-06T07:32:00.7586Z",
                    "last_seen": "2019-09-06T07:32:00.7586Z",
                    "count": 1,
                    "where_sighted_refs": ["identity--20b0b40f-ee42-405e-802b-c576ff3f722d"],
                    "observed_data_refs": ["observed-data--8b9ad982-8ea8-435e-aacc-a51161e95849"],
                    "type": "sighting",
                    "sighting_of_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "identity_class": "community",
                    "name": "Community OliveDrab",
                    "description": "No description",
                    "type": "identity",
                    "created": "2019-09-06T07:32:00.754Z",
                    "modified": "2019-09-06T07:32:00.754Z",
                },
                {
                    "id": "identity--20b0b40f-ee42-405e-802b-c576ff3f722d",
                    "identity_class": "entity",
                    "name": "Vessel 1235",
                    "type": "identity",
                    "created": "2019-09-06T07:32:00.755Z",
                    "modified": "2019-09-06T07:32:00.755Z",
                },
                {
                    "id": "observed-data--8b9ad982-8ea8-435e-aacc-a51161e95849",
                    "first_observed": "2019-09-06T06:48:15.7553Z",
                    "last_observed": "2019-09-06T06:48:15.7553Z",
                    "created": "2019-09-06T07:32:00.755Z",
                    "modified": "2019-09-06T07:32:00.755Z",
                    "objects": {
                        "0": {"type": "ipv4-addr", "value": "10.227.10.91"},
                        "1": {"type": "ipv4-addr", "value": "192.0.0.241"},
                        "2": {
                            "type": "network-traffic",
                            "start": "2019-09-06T06:48:15.7553Z",
                            "src_ref": "0",
                            "dst_ref": "1",
                            "dst_port": 443,
                            "protocols": ["ipv4", "tcp", "ssl"],
                        },
                    },
                    "number_observed": 1,
                    "x_sic_custom_properties": {
                        "site_id": 1235,
                        "install_id": "7620",
                        "soc_analyst_required": True,
                        "vessel_imo": "0",
                        "zone_name": "High-Priority Internet",
                        "zone_id": "185",
                        "logs_download_enabled": True,
                        "customer_id": "BIZ1000",
                        "service_subscribed": True,
                        "zone_type": "UNSPECIFIED_ZONE",
                        "zone_priority_level": "HIGH_TRAFFIC",
                        "unkown_service_option": False,
                    },
                    "x_sic_entity_by_ref": "identity--20b0b40f-ee42-405e-802b-c576ff3f722d",
                    "type": "observed-data",
                },
                {
                    "id": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                    "name": "RAT LightSteelBlue",
                    "description": "Traffic associated to a Remote Administration Tool",
                    "created": "2019-09-06T07:32:00.757Z",
                    "modified": "2019-09-06T07:32:00.757Z",
                    "pattern": "[ipv4-addr:value='192.0.0.241']",
                    "labels": ["malicious-traffic", "rat-traffic"],
                    "x_sic_alert": {
                        "type": {
                            "category": "malicious-traffic",
                            "value": "rat-traffic",
                            "description": "eCSIRT-SEKOIA",
                        },
                        "generation_mode": "automatic",
                        "severity": 95,
                    },
                    "type": "indicator",
                    "valid_from": "2019-09-06T07:32:00.757121Z",
                },
                {
                    "id": "relationship--88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "relationship--6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "relationship--ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "relationship--2c5f2708-be09-4703-8790-38f600e05328",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--2c5f2708-be09-4703-8790-38f600e05328",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "relationship--9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "relationship--4ba7d84d-0291-498e-b661-3cec45943ac7",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--4ba7d84d-0291-498e-b661-3cec45943ac7",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "relationship--7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "type": "relationship",
                    "source_ref": "course-of-action--7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                    "relationship_type": "mitigates",
                    "target_ref": "indicator--b686f467-fcab-412b-9633-d68982e1be82",
                },
                {
                    "id": "course-of-action--88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                    "name": "Countermeasure 88ff9b6e-a0ee-4470-92ff-d9f7fe1b6232",
                    "description": "Block the IP address of the destination system",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Block the IP address of the destination system",
                            "object": {
                                "action": "deny",
                                "actuator": {"network-firewall": {"location": "$GLOBAL"}},
                                "target": {"ip_addr": "192.0.0.241"},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 80.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                {
                    "id": "course-of-action--6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                    "name": "Countermeasure 6e351037-2e65-44a5-9891-c9a3f01c0e8f",
                    "description": "Retrieve the list of running processes",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Retrieve the list of running processes",
                            "object": {
                                "action": "query",
                                "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"process": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 57.5, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                {
                    "id": "course-of-action--ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                    "name": "Countermeasure ad6f06cc-7c96-4920-8c4e-d120eaec8a4a",
                    "description": "Search for additional information on the case",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Search for additional information on the case",
                            "object": {
                                "action": "investigate",
                                "target": {"artifact": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 72.5, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                {
                    "id": "course-of-action--2c5f2708-be09-4703-8790-38f600e05328",
                    "name": "Countermeasure 2c5f2708-be09-4703-8790-38f600e05328",
                    "description": "Collect memory to analyze malware later",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Collect memory to analyze malware later",
                            "object": {
                                "action": "snapshot",
                                "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"memory": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 50.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                {
                    "id": "course-of-action--9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                    "name": "Countermeasure 9c34bb79-5c48-4e0b-89cb-37d0eb1b5ba1",
                    "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic destination",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic destination",
                            "object": {
                                "action": "copy",
                                "actuator": {"network-fpc": {}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"ip_connection": {"dst-addr": "192.0.0.241"}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 70.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                {
                    "id": "course-of-action--4ba7d84d-0291-498e-b661-3cec45943ac7",
                    "name": "Countermeasure 4ba7d84d-0291-498e-b661-3cec45943ac7",
                    "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic source",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Record the traffic coming from the suspicious computer for analysis based on the IP address of the traffic source",
                            "object": {
                                "action": "copy",
                                "actuator": {"network-fpc": {}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"ip_connection": {"src-addr": "192.0.0.241"}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 70.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
                {
                    "id": "course-of-action--7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                    "name": "Countermeasure 7aa941f8-bc0a-4438-a7f7-d70e5c2a0507",
                    "description": "Launch a forensics tool to collect information on suspicious system",
                    "created_by_ref": "identity--cc93fe3f-c26b-4eb1-82f7-082209cf1892",
                    "created": "2019-09-06T07:32:00.759Z",
                    "modified": "2019-09-06T07:32:00.759Z",
                    "action-steps": [
                        {
                            "type": "openc2",
                            "name": "1",
                            "description": "Launch a forensics tool to collect information on suspicious system",
                            "object": {
                                "action": "start",
                                "actuator": {"endpoint": {"ip_addr": "10.227.10.91"}},
                                "args": {"where": "$DROP_ZONE"},
                                "target": {"process": {}},
                            },
                        }
                    ],
                    "x_sic_countermeasure": {"relevance": 80.0, "dynamic_relevance": 0},
                    "type": "course-of-action",
                },
            ],
        },
        "urgency": {
            "severity": 95,
            "value": 47,
            "criticity": 0,
            "current_value": 47,
            "display": "High",
        },
        "rule": {
            "description": "Traffic associated to a Remote Administration Tool",
            "name": "RAT LightSteelBlue",
            "type": None,
            "uuid": "b686f467-fcab-412b-9633-d68982e1be82",
            "severity": 95,
            "pattern": "[ipv4-addr:value='192.0.0.241']",
        },
        "updated_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
        "similar": 0,
        "history": [
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "3060ad65-a55f-4425-8e28-54b22fd67509",
                "entry_type": "alert",
                "created_at": 1567755123,
                "alert": {"status": "Ongoing"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "5bbaa276-3aa8-46bf-81a3-2ea3fac87867",
                "entry_type": "alert",
                "created_at": 1567755120,
                "alert": {"status": "Pending"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "757a6a83-fa5e-499b-81de-d9fabd971b6c",
                "countermeasure": {
                    "uuid": "de66615c-4e28-4da4-bfa4-7b5caf5ee19e",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "a8e7f933-dfc6-4b29-8852-1797bf6067bc",
                "countermeasure": {
                    "uuid": "51d50a83-31da-46b0-aa22-5adcd37aedb2",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "ab5ad122-2dd4-4a09-916d-d9b19247675b",
                "countermeasure": {
                    "uuid": "51d50a83-31da-46b0-aa22-5adcd37aedb2",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "ef0314ba-15b6-41e8-9b7c-566f62968b2d",
                "countermeasure": {
                    "uuid": "909fda4e-6823-41bb-8998-afd75424a6b3",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "2e1a4745-ab4b-45bb-8629-50a6838fb073",
                "countermeasure": {
                    "uuid": "909fda4e-6823-41bb-8998-afd75424a6b3",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "3322ee5a-2686-4712-9bbb-83a1890409e1",
                "countermeasure": {
                    "uuid": "ce4abd6b-1553-413e-b549-9392de801c52",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "db286da8-8487-4b34-803c-3ad31edbe45b",
                "countermeasure": {
                    "uuid": "ce4abd6b-1553-413e-b549-9392de801c52",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "92733aa5-8bdf-4041-98e1-ba2acb1e2836",
                "countermeasure": {
                    "uuid": "d6ce6868-207c-4a59-9775-55fdd1c2318c",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "4bd9572a-e421-4eb6-92d3-a5c7d7e6d161",
                "countermeasure": {
                    "uuid": "d6ce6868-207c-4a59-9775-55fdd1c2318c",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "d52c5560-51e5-461b-8224-d1332874558c",
                "countermeasure": {
                    "uuid": "ced96fc1-d6f1-4935-9978-3f367552234c",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "63407c1d-d3f5-43d2-ba5b-5dc9986f1bd9",
                "countermeasure": {
                    "uuid": "ced96fc1-d6f1-4935-9978-3f367552234c",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "06404c71-cc9d-49bf-bbea-994ffbcdb923",
                "countermeasure": {
                    "uuid": "cb83cf8b-c31a-4df7-b05b-c78ef3446fc2",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "16987e43-af8a-4864-ae24-cef2ee118366",
                "countermeasure": {
                    "uuid": "cb83cf8b-c31a-4df7-b05b-c78ef3446fc2",
                    "status": "created",
                },
                "entry_type": "countermeasure_action_step",
                "created_at": 1567755120,
                "countermeasure_action_step": {"name": "1", "status": "created"},
                "created_by_type": "application",
            },
            {
                "created_by": "59899459-d385-48da-9c0e-1d91ebe42c4a",
                "history_comments": [],
                "uuid": "144602ea-dc46-477e-b40d-fa0c09dbd8f5",
                "countermeasure": {
                    "uuid": "de66615c-4e28-4da4-bfa4-7b5caf5ee19e",
                    "status": "created",
                },
                "entry_type": "countermeasure",
                "created_at": 1567755120,
                "created_by_type": "application",
            },
        ],
        "community_uuid": "cc93fe3f-c26b-4eb1-82f7-082209cf1892",
        "created_at": 1567755120,
        "status": {
            "uuid": "1f2f88d5-ff5b-48bf-bbbc-00c2fff82d9f",
            "name": "Ongoing",
            "description": "Countermeasures will be applied",
        },
        "target": "192.0.0.241",
    }
